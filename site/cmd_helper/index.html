<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Command-Line Helper</title>
	<link rel="stylesheet" href="../site.css">
	<link rel="stylesheet" href="helper.css">
</head>
<body>
	<div id="header">
		<div id="back">
			<a href="../index.html">&lt; Back</a>
		</div>
		Command-Line Helper
		<div id="osSelect">
			<label for="os">Operating System</label>
			<select name="os" id="osSelection" onchange="changeos();">
				<option value="nix">Linux</option>
				<option value="win" disabled>Windows Command Prompt</option>
				<option value="winps" disabled>Windows Powershell</option>
			</select>
		</div>
	</div>
	<div id="output">
		<div id="outputCmd">Output: No Output</div>
		<button onclick="copyOutput();">Copy</button>
	</div>
	<div id="outputSections">
		<h2>Current Instructions:</h2>
		<div id="instructions">

		</div>
	</div>
	<div id="sections">
		<div id="user">
			<h1>User Commands</h1>
			<button id="createUser">Create User</button>
			<button id="deleteUser">Delete User</button>
		</div>
		<div id="user">
			<h1>Group Commands</h1>
			<button id="createGroup">Create Group</button>
			<button id="deleteGroup">Delete Group</button>
			<button id="addUserToGroup">Delete Group</button>
		</div>
	</div>
	<div id="footer">
		<span>
			This site was made and maintained by <a href="https://github.com/EvieUwU"> EvieUwU </a>
		</span>
	</div>
</body>
<style>
body, html {
	margin: 0;
	padding: 0;
}
</style>
<script>
var os = "nix";
function changeos() {
	os = document.querySelector("select#osSelection").value;
	switch (os) {
		case "nix":
			data = nix_data;
			break;
		case "win":
			data = win_data;
			break;
		case "winps":
			data = winps_data;
			break;
		default:
			break;
	}
}
function copyOutput() {
	navigator.clipboard.writeText(output.innerText.replace("Output: ", ""));
}
function setOutput(setTo) {
	output.innerText = `Output: ${setTo}`;
}
function generateOutput() {
	const children = instructions.children;
	if (children.length !== 0) {
		var out = children[0].value;
		for (var i = 1; i < children.length; i++) {
			const node = children[i];
			out += ` && ${node.value}`;
		}
		setOutput(out);
	} else {
		setOutput("No Output");
	}
}
function addInstruction(inst, command) {
	const instruction = document.createElement("div");
	instruction.id = "instruction";
	instruction.value = inst;
	const txt = document.createElement("span");
	txt.id = "instText";
	txt.innerText = command;
	instruction.appendChild(txt);
	const del = document.createElement("button");
	del.id = "deleteButton";
	del.innerText = "Delete";
	del.onclick = function(){deleteInstruction(del);}
	instruction.appendChild(del);
	instructions.appendChild(instruction);
	generateOutput();
}
function deleteInstruction(button) {
	button.parentElement.parentElement.removeChild(button.parentElement);
	generateOutput();
}
const nix_data = {
	"createUser": "sudo useradd -m $[Username To Create]",
	"deleteUser": "sudo userdel ${-r:Delete Home?:bool} $[Username To Delete]",
	"createGroup": "sudo groupadd $[Group To Create]",
	"deleteGroup": "sudo groupdel $[Group To Delete]"
}
var data = nix_data;
const requiredVarRepl = /\$\[(.+?)\]/g;
const switchRepl = /\${(.+?)}/g;
const output = document.querySelector("div#outputCmd");
const instructions = document.querySelector("div#instructions");
function buttonPressed(button) {
	const cmd = button.id;
	if (!(cmd in data)) {
		alert("Unknown command selected.");
		return;
	}
	const baseline = data[cmd];
	var toReplace = [...baseline.matchAll(requiredVarRepl)];
	var final = baseline;
	for (const i in toReplace) {
		const value = toReplace[i];
		var ppt = value[1];
		var ans = prompt(ppt);
		if (ans === null || ans === "") {
			alert("Cancelled.");
			return;
		}
		final = final.replace(value[0], ans);
	}
	toReplace = [...baseline.matchAll(switchRepl)];
	for (const i in toReplace) {
		const value = toReplace[i];
		var all = value[1];
		var ppt = all.split(":")[1];
		var toAdd = all.split(":")[0];
		var type = all.split(":")[2];
		if (type === "bool") {
			var ans = prompt(`${ppt} (Y/N)`).toUpperCase();
			if (ans === null || ans === "") {
				alert("Cancelled.");
				return;
			}
			if (ans === "Y" || ans === "YES") {
				final = final.replace(value[0], toAdd);
			} else {
				final = final.replace(value[0], "");
			}
		} else {
			if (val) {
				final = final.replace(value[0], toAdd);
			} else {
				final = final.replace(value[0], "");
			}
		}
	}
	addInstruction(final, button.innerText);
}
var buttons = document.querySelectorAll("div#sections > div > button");
buttons.forEach((value) => value.onclick = function(){buttonPressed(value)});
</script>
</html>