<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>*nix Command Helper</title>
	<link rel="stylesheet" href="/index.css">
	<link rel="stylesheet" href="../../site.css">
	<link rel="stylesheet" href="helper.css">
</head>
<body style="justify-content: space-evenly;">
	<div>
		<a href="../index.html">&lt; Back</a>
		<br style="margin-bottom:16px;">
	</div>
	<p></p>
	<div>
		<div id="output">
			Output:
			<textarea disabled id="outputCmd"></textarea>
			<button onclick="copyOutput();">Copy Command</button>
			<label for="os">Operating System</label>
			<select name="os" id="osSelection" onchange="changeos();">
				<option value="nix">Linux</option>
				<option value="win" disabled>Windows Command Prompt - Coming Soon</option>
				<option value="winps" disabled>Windows Powershell - Coming Soon</option>
			</select>
		</div>
		<div id="sections">
			<div id="user">
				<h1> User Commands </h1>
				<div>
					<label for="username">Username</label>
					<input id="username" onkeyup="textInputChanged(this);">
				</div>
				<div>
					<label for="createUser">Create User</label>
					<input type="checkbox" id="createUser">
				</div>
				<div>
					<label for="deleteUser">Delete User</label>
					<input type="checkbox" id="deleteUser">
					<label for="deleteHome">Delete Home?</label>
					<input type="checkbox" id="deleteHome">
				</div>
			</div>
		</div>
	</div>
	<div id="footer">
		This site was made and maintained by <a href="https://github.com/EvieUwU"> EvieUwU </a>
	</div>
</body>
<style>
body, html {
	margin: 0;
	padding: 0;
}
body {
	height: 750px;
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
}
</style>
<script>
var os = "nix";
function changeos() {
	os = document.querySelector("select#osSelection").value;
}
function copyOutput() {
	navigator.clipboard.writeText(output.value);
}
const data = {
	"createUser": "usermod -m $[username]",
	"deleteUser": "usermod ${-r:deleteHome} $[username]"
}
const requiredVarRepl = /\$\[(.+?)\]/g;
const switchRepl = /\${(.+?)}/g;
const output = document.querySelector("textarea#outputCmd");
function checkboxSelected(checkbox) {
	if (!checkbox.checked) {
		output.value = "";
		return;
	}
	inputs.forEach((value) => {
		if (value != checkbox) {
			value.checked = false;
		}
	});
	const cmd = checkbox.id;
	if (!(cmd in data)) {
		alert("Unknown command selected.");
		return;
	}
	const baseline = data[cmd];
	var toReplace = [...baseline.matchAll(requiredVarRepl)];
	var final = baseline;
	for (const i in toReplace) {
		const value = toReplace[i];
		var toLookUp = value[1];
		var node = document.querySelector(`input#${toLookUp}`);
		if (node === null) {
			alert(`Couldn't find ${toLookUp}`);
			return;
		}
		var val = node.value;
		final = final.replace(value[0], val);
	}
	toReplace = [...baseline.matchAll(switchRepl)];
	for (const i in toReplace) {
		const value = toReplace[i];
		var all = value[1];
		var toLookUp = all.split(":")[1];
		var toAdd = all.split(":")[0];
		var node = document.querySelector(`input[type=checkbox]#${toLookUp}`);
		if (node === null) {
			alert(`Couldn't find ${toLookUp}`);
			return;
		}
		var val = node.value;
		if (val) {
			final = final.replace(value[0], toAdd);
		} else {
			final = final.replace(value[0], "");
		}
	}
	output.value = final;
}
function textInputChanged(input) {
	inputs.forEach((value) => {
		if (value.checked) {
			checkboxSelected(value);
		}
	});
}
var inputs = document.querySelectorAll("input");
var checkboxes = [];
var textInputs = [];
inputs.forEach((value) => {
	if (value.type === "checkbox") {
		checkboxes.push(value)
	} else if (value.type === "text") {
		textInputs.push(value);
	}
});

checkboxes.forEach((value) => value.onchange = function(){checkboxSelected(value)})
textInputs.forEach((value) => value.onchange = function(){textInputChanged(value)})
</script>
</html>